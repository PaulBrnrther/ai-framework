#!/usr/bin/env python3
"""Parse repos from a ticket YAML for a given branch."""
import sys

yaml_file = sys.argv[1]
branch = sys.argv[2]

with open(yaml_file) as f:
    lines = f.readlines()

in_branch = False
for line in lines:
    stripped = line.rstrip()
    if stripped == f"  {branch}:":
        in_branch = True
        continue
    # Next branch
    if in_branch and len(stripped) > 2 and stripped[0:2] == "  " and stripped[2] != " " and "/" in stripped:
        break
    if in_branch and stripped.startswith("      ") and stripped.endswith(":") and not stripped.strip().startswith("plugins"):
        repo = stripped.strip().rstrip(":")
        print(repo)
